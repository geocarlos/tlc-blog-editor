(this.webpackJsonpcomposer=this.webpackJsonpcomposer||[]).push([[0],{213:function(e,t,n){},236:function(e,t){},238:function(e,t){},249:function(e,t){},251:function(e,t){},278:function(e,t){},280:function(e,t){},281:function(e,t){},286:function(e,t){},288:function(e,t){},307:function(e,t){},319:function(e,t){},322:function(e,t){},353:function(e,t,n){"use strict";n.r(t);var c=n(4),a=n(0),i=n.n(a),o=n(12),r=n.n(o),s=(n(213),n(27)),u=n(116),l=n(391),d="https://perz1z7tlf.execute-api.us-east-2.amazonaws.com/prod/api/v1",b=n(59),j=n.n(b),h=function(){return j.a.get("".concat(d,"/posts/categories")).then((function(e){return e.data})).catch((function(e){return e.data}))};j.a.interceptors.request.use((function(e){return e.url&&!e.url.includes(d)?e:l.a.currentSession().then((function(t){return e.headers.Authorization="Bearer ".concat(t.getIdToken().getJwtToken()),e})).catch((function(t){return console.log(t),e}))}));var g=n(392),f=n(22),O=n(202),m=n(14),p=n(51),v=n(385),x=n(390),y=Object(v.a)({auth:{width:"20rem",height:"20rem",margin:"auto",display:"flex",flexWrap:"wrap",alignItems:"center",border:"solid thin #999",borderRadius:"1rem",padding:"1rem"},authForm:{width:"90%",margin:"auto","& .input":{height:"fit-content",width:"100%",margin:"1rem 0"}}}),w=function(){var e=y(),t=Object(a.useState)({username:"",password:""}),n=Object(s.a)(t,2),i=n[0],o=n[1],r=Object(a.useContext)(R).setIsLoggedIn,u=function(e){var t=e.target;o((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},t.name,t.value))}))};return Object(c.jsx)("div",{className:e.auth,children:Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),l.a.signIn(i.username,i.password).then((function(){return r(!0)})).catch((function(e){return console.log(e)}))},className:e.authForm,children:[Object(c.jsx)("div",{className:"input",children:Object(c.jsx)(x.a,{onChange:u,name:"username",label:"Username",type:"email",className:"input"})}),Object(c.jsx)("div",{className:"input",children:Object(c.jsx)(x.a,{onChange:u,name:"password",label:"Password",type:"password",className:"input"})}),Object(c.jsx)("div",{children:Object(c.jsx)(g.a,{variant:"contained",color:"primary",type:"submit",children:"Login"})})]})})},C=Object(v.a)({categoryEditor:{position:"absolute",background:"white",top:"-100%",left:"100%",height:"10rem",width:"20rem",display:"flex",justifyContent:"center",alignItems:"center"}}),I=function(e){var t=e.language,n=Object(a.useState)(""),i=Object(s.a)(n,2),o=i[0],r=i[1],u=Object(a.useContext)(R).setCategories,l=C();return Object(c.jsxs)("div",{className:l.categoryEditor,children:[Object(c.jsx)(x.a,{label:"name",value:o,onChange:function(e){return r(e.target.value)}}),Object(c.jsx)(g.a,{onClick:function(){var e;(e={name:o,language:t},j.a.post("".concat(d,"/posts/categories"),e).then((function(e){return e.data})).catch((function(e){return e.data}))).then((function(){h().then((function(e){return u(e)})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))},children:"Save"})]})},L=Object(v.a)({editor:{display:"grid",gridTemplateColumns:"50% 50%",width:"90%",minHeight:"90%",margin:"auto",columnGap:"1.5rem"},column:{width:"100%"},bodyInput:{minHeight:"10rem",width:"100%",background:"#eee"},categories:{display:"inline",width:"fit-content",position:"relative",overflow:"visible"}}),S=[{label:"English",value:"en"},{label:"Portugu\xeas",value:"pt"}],E=function(){var e=L(),t=Object(a.useRef)(),n=Object(a.useState)({uri:"",title:"",body:"",language:"en",category:"",author:""}),i=Object(s.a)(n,2),o=i[0],r=i[1],u=Object(a.useState)(!1),l=Object(s.a)(u,2),b=l[0],h=l[1],O=Object(a.useContext)(R),m=O.selectedPost,v=O.categories;Object(a.useEffect)((function(){m&&r(m)}),[m]);var y=function(e){var t=e.target;t.name||r((function(e){return Object(f.a)(Object(f.a)({},e),{},{body:t.innerText})})),r((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(p.a)({},t.name,t.value))}))};return Object(c.jsxs)("div",{className:e.editor,children:[Object(c.jsxs)("div",{className:e.column,children:[Object(c.jsx)("h2",{children:"New Post"}),Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t,n=o.uri?o.uri:o.title.toLocaleLowerCase().replace(/\s/g,"-");(t=Object(f.a)(Object(f.a)({},o),{},{uri:n,createdAt:m.createdAt||(new Date).getTime()}),j.a.post("".concat(d,"/posts"),t).then((function(e){return e.data})).catch((function(e){return e.data}))).then((function(){window.location.reload()})).catch((function(e){return console.log(e)}))},children:[Object(c.jsx)(x.a,{label:"title",name:"title",value:o.title,onChange:y,style:{margin:"1rem 0",width:"100%"}}),Object(c.jsx)("select",{value:o.language,onChange:y,name:"language",children:S.map((function(e){return Object(c.jsx)("option",{value:e.value,children:e.label},e.value)}))}),Object(c.jsxs)("div",{className:e.categories,children:[Object(c.jsx)("select",{value:o.category,onChange:y,name:"category",children:v.filter((function(e){return e.language===o.language})).map((function(e){return Object(c.jsx)("option",{value:e.name,children:e.name},e.name)}))}),Object(c.jsx)(g.a,{onClick:function(){return h((function(e){return!e}))},children:b?"Close":"Add Category"}),b&&Object(c.jsx)(I,{language:o.language})]}),Object(c.jsx)("text-input",{ref:t,onMouseUp:function(){if(t&&t.current){var e;t.current;console.log(null===(e=window.getSelection())||void 0===e?void 0:e.toString())}},className:e.bodyInput,initialValue:null===m||void 0===m?void 0:m.body,contentEditable:!0,onInput:y}),Object(c.jsx)("div",{style:{padding:"1rem 0"},children:Object(c.jsx)(g.a,{size:"small",variant:"contained",type:"submit",children:"Save"})})]})]}),Object(c.jsx)("div",{className:e.column,children:Object(c.jsx)("post-body-edit",{body:o.body})})]})},N=Object(v.a)({postList:{width:"90%",minHeight:"90%",margin:"0 auto",alignSelf:"flex-start"},postItem:{margin:".5rem 0",padding:"1rem",border:"solid thin grey"}}),k=function(){var e=N(),t=Object(a.useContext)(R),n=t.posts,i=t.setSelectedPost,o=Object(m.g)();return Object(c.jsxs)("div",{className:e.postList,children:[Object(c.jsx)("h1",{children:"All Posts"}),n.map((function(t){return Object(c.jsxs)("div",{className:e.postItem,onClick:function(){i(t),o.push("/editor")},children:[Object(c.jsx)("h2",{children:t.title}),Object(c.jsx)("post-body",{children:t.body})]},t.title)})),Object(c.jsx)("div",{style:{position:"fixed",right:"5rem",bottom:"1rem"},children:Object(c.jsx)(g.a,{onClick:function(){o.push("/editor"),i(null)},children:"New post"})})]})},A=function(e){var t=e.isLoggedIn,n=e.roles,a=e.path,i=e.userRoles,o=e.component,r=Object(O.a)(e,["isLoggedIn","roles","path","userRoles","component"]);return t&&n.some((function(e){return i.includes(e)}))?Object(c.jsx)(m.b,Object(f.a)({render:function(e){return o&&Object(c.jsx)(o,Object(f.a)({},e))}},r)):Object(c.jsx)(m.b,Object(f.a)({path:a,render:function(){return t?Object(c.jsx)("h1",{children:"YOU ARE NOT ALLOWED TO SEE THE PAGE!"}):Object(c.jsx)(m.a,{to:"/login"})}},r))},T=function(e){var t=e.isLoggedIn,n=e.userRoles;return Object(c.jsxs)(m.d,{children:[Object(c.jsx)(A,{exact:!0,path:"/",component:k,isLoggedIn:t,userRoles:n,roles:["BlogAuthor"]}),Object(c.jsx)(A,{exact:!0,path:"/editor",component:E,isLoggedIn:t,userRoles:n,roles:["BlogAuthor"]}),Object(c.jsx)(m.b,{path:"/login",render:function(){return t?Object(c.jsx)(m.a,{to:"/"}):Object(c.jsx)(w,{})}})]})},P=n(81),R=Object(a.createContext)({});u.a.configure({Auth:{mandatorySignIn:!0,region:"us-east-2",userPoolId:"us-east-2_M7RE4lOGi",userPoolWebClientId:"2994454dd3jst6ttbitov25399"}});var H=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),r=Object(s.a)(o,2),u=r[0],b=r[1],f=Object(a.useState)(null),O=Object(s.a)(f,2),m=O[0],p=O[1],v=Object(a.useState)(null),x=Object(s.a)(v,2),y=x[0],w=x[1];return Object(a.useEffect)((function(){l.a.currentAuthenticatedUser().then((function(){return w(!0)})).catch((function(e){console.log(e),w(!1)}))}),[]),Object(a.useEffect)((function(){y&&(j.a.get("".concat(d,"/posts")).then((function(e){return e.data})).catch((function(e){return e.data})).then((function(e){i(e)})).catch((function(e){console.log(e)})),h().then((function(e){b(e)})).catch((function(e){console.log(e)})))}),[y]),null!==y?Object(c.jsxs)("div",{className:"container",children:[y&&Object(c.jsx)("header",{className:"header",children:Object(c.jsx)(g.a,{style:{height:"fit-content"},onClick:function(){l.a.signOut().then((function(){return w(!1)})).catch((function(e){return console.log(e)}))},children:"Log out"})}),Object(c.jsx)(P.a,{basename:".",children:Object(c.jsx)(R.Provider,{value:{setIsLoggedIn:w,posts:n,categories:u,selectedPost:m,setSelectedPost:p,setCategories:b},children:Object(c.jsx)(T,{isLoggedIn:y,userRoles:["BlogAuthor"]})})})]}):null},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,394)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),i(e),o(e)}))},B=n(86),F=n(87),z=n(88),D=n(89),U=n(90),G=function(){var e=function(e){Object(z.a)(n,e);var t=Object(D.a)(n);function n(){return Object(B.a)(this,n),t.apply(this,arguments)}return Object(F.a)(n,[{key:"connectedCallback",value:function(){var e=this.innerText.replace(/<script>|<script src=("|').*("|')(\s+|)>/g,"&lt;script&gt;").replace(/<\/script>/g,"&lt;/script&gt;");this.innerHTML=e}}]),n}(Object(U.a)(HTMLElement));window.customElements.define("post-body",e);var t=function(e){Object(z.a)(n,e);var t=Object(D.a)(n);function n(){return Object(B.a)(this,n),t.apply(this,arguments)}return Object(F.a)(n,[{key:"attributeChangedCallback",value:function(e,t,n){if("body"===e&&t!==n){var c=this.getAttribute("body"),a=null===c||void 0===c?void 0:c.replace(/<script>|<script src=("|').*("|')(\s+|)>/g,"&lt;script&gt;").replace(/<\/script>/g,"&lt;/script&gt;");this.innerHTML=a||""}}}],[{key:"observedAttributes",get:function(){return["body"]}}]),n}(Object(U.a)(HTMLElement));window.customElements.define("post-body-edit",t);var n=function(e){Object(z.a)(n,e);var t=Object(D.a)(n);function n(){return Object(B.a)(this,n),t.apply(this,arguments)}return Object(F.a)(n,[{key:"connectedCallback",value:function(){var e=this.getAttribute("initialValue"),t=this.getAttribute("className");t&&this.classList.add(t),this.style.display="block",this.textContent=e}}],[{key:"observedAttributes",get:function(){return["initialValue","className"]}}]),n}(Object(U.a)(HTMLElement));window.customElements.define("text-input",n)};r.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(H,{})}),document.getElementById("root")),G(),M()}},[[353,1,2]]]);
//# sourceMappingURL=main.c8a2af6a.chunk.js.map